<link rel="import" href="../polymer/polymer.html" />
<link rel="import" href="../t-sessionstorage/t-sessionstorage.html">
<link rel="import" href="../t-notify/t-notify.html">
<link rel="import" href="../t-shared-lib/t-search-page-behaviour.html">
<link rel="import" href="../t-shared-lib/t-search-api.html">

<link rel="import" href="t-hotel-search.html">
<link rel="import" href="t-hotel-search-api-decorator.html">
<!--
This component is a form that allows a user to search for Hotels.
It exposes certain prperties which allow control over different aspects
of searching.

There are fundamentally three types of properties that form the public
api of this component.

__User input__: Properties like `location`, `adultCount` etc. reflect the user input
necessary for searching

-->
<dom-module id="t-hotel-search-page">
    <style include="iron-flex">
        :host {
            display:block;
            font-family: var(--primary-font-family);
        }
        
    </style>
    <template>
        
        <t-notify id="notify" message="" type="error"></t-notify>
        <t-hotel-search 
            id="searchView" 
            api-base-url="[[apiBaseUrl]]" 
            data-url="[[apiBaseUrl]]api/content/autosuggest/" query-params="token=[[authToken]]" 
            on-t-hotel-search-validate="onSearch">
        </t-hotel-search>
        

        <t-hotel-search-api-decorator
            input="[[searchedData]]"
            output="{{searchRequest}}">
        </t-hotel-search-api-decorator>
        <t-search-api
            id="searchApi" 
            data="[[searchRequest]]" 
            api-base-url="[[apiBaseUrl]]" 
            api-relative-url="api/hotel/search" 
            auth-token="[[authToken]]" 
            on-t-hotel-search-success="onSearchSuccess"
            on-t-hotel-search-error="onSearchError">
        </t-search-api>
        <t-sessionstorage
            id="sessionStore"
            api-url-format="{{apiUrlFormat}}"
            on-t-sessionstorage-save-success="onSessionSave"
            on-t-sessionstorage-load-success="onSessionLoad">
        </t-sessionstorage>
    </template>
</dom-module>
<script>
    (function () {
        Polymer({
            is: 't-hotel-search-page',
            
            
            properties: {
                productName: {
                    type:String,
                    value:'Hotel'
                }   
            },

            behaviors:[Polymer.SearchPageBehaviour]
        });        
    })();
</script>
